Copyright (c) 2000, 2021, Oracle and/or its affiliates.

This is a release of MySQL, an SQL database server.

License information can be found in the LICENSE file.

In test packages where this file is renamed README-test, the license
file is renamed LICENSE-test.

This distribution may include materials developed by third parties.
For license and attribution notices for these materials,
please refer to the LICENSE file.

For further information on MySQL or additional documentation, visit
  http://dev.mysql.com/doc/

For additional downloads and the source of MySQL, visit
  http://dev.mysql.com/downloads/

MySQL is brought to you by the MySQL team at Oracle.


## BUILD

Cmake

```
cmake ../mysql-server -DWITH_BOOST=/usr/local/boost_1_73_0 -DCMAKE_INSTALL_PREFIX=/out -DCPACK_MONOLITHIC_INSTALL=1  DWITH_DEBUG=1
make -j12
make package
```

build Docker container called `mysql-test`

```
docker build -t mysql-test .
```

## RUN 

```
docker run --network host --cap-add=sys_nice -v /mnt/local2/tim/my-pmem.cnf:/etc/mysql/my.cnf -v /mnt/pmem1/mysql:/var/lib/redo  -e MYSQL_ROOT_PASSWORD=secret -e MYSQL_USER=mysql -e MYSQL_PASSWORD=secret --name mysql8-pmem -d tthebst/mysql-pmem mysqld --default-authentication-plugin=mysql_native_password  --debug=d:S:F:L:f
```

### Stop by name

````
docker rm $(docker stop $(docker ps -a -q --filter name=mysql8 --format="{{.ID}}"))
```

### simple run docker

````
docker build -t mysql-test . &&  docker rm $(docker stop $(docker ps -a -q --filter name=mysql8 --format="{{.ID}}")) && docker run --network host --cap-add=sys_nice -v /mnt/local2/tim/my-pmem.cnf:/etc/mysql/my.cnf -v /mnt/pmem1/redo:/var/lib/redo  -e MYSQL_ROOT_PASSWORD=secret -e MYSQL_USER=mysql -e MYSQL_PASSWORD=secret --name mysql8-pmem -d mysql-test mysqld --default-authentication-plugin=mysql_native_password  --debug=d:S:F:L:f
 ```

## RUN test


In the build directory run 
```
make install
```

In `/out` run 

```
cd /out/mysql-test
./mysql-test-run.pl --force --suite=binlog

./mysql-test-run.pl --defaults-extra-file=/mnt/local2/tim/my-pmem.cnf --force --suite=innodb
./mysql-test-run.pl --defaults-extra-file=/mnt/local2/tim/my-pmem.cnf --force --suite=innodb_gis
./mysql-test-run.pl --defaults-extra-file=/mnt/local2/tim/my-pmem.cnf --force --suite=innodb_undo
./mysql-test-run.pl --defaults-extra-file=/mnt/local2/tim/my-pmem.cnf --force --suite=innodb_zip
```

With docker

```
docker run -v /mnt/local2/tim/my-pmem.cnf:/etc/mysql/my.cnf -v /mnt/pmem1/redo:/var/lib/redo --cap-add=sys_nice -e MYSQL_TMP_DIR=/var/lib/redo  -e MYSQL_ROOT_PASSWORD=secret -e MYSQL_USER=mysql -d  -e MYSQL_PASSWORD=secret --name mysql8-testsuite tthebst/mysql-pmem-debug /bin/su -m -c "export MYSQL_TMP_DIR=/var/lib/redo && cd /usr/local/mysql/mysql-test && ./mysql-test-run.pl --big-test --mysqld=--innodb-log-group-home-dir=/var/lib/redo --force --suite=innodb,innodb_gis,innodb_undo,innodb_zip" -m mysql

specific

docker run -v /mnt/local2/tim/my-pmem.cnf:/etc/mysql/my.cnf -v /mnt/pmem1/redo:/var/lib/redo --cap-add=sys_nice -e MYSQL_TMP_DIR=/var/lib/redo  -e MYSQL_ROOT_PASSWORD=secret -e MYSQL_USER=mysql -e MYSQL_PASSWORD=secret --name mysql8-testsuite tthebst/mysql-pmem-debug /bin/su -m -c "export MYSQL_TMP_DIR=/var/lib/redo && cd /usr/local/mysql/mysql-test && ./mysql-test-run.pl --big-test --mysqld=--innodb-log-group-home-dir=/var/lib/redo --force innodb.innodb_buffer_pool_load" -m mysql

```

innodb.innodb_buffer_pool_load